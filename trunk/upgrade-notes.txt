================
REPOSITORY SETUP
================

So you want to try out Vanilla 0.9.3?

I'm sorry to tell you that there is a bit of work ahead of you. The good news
is that you've made it this far already. So you've gotten SVN installed and
working on your machine, and you SVN Checkout'ed these files. The first step
you need to take now is to get the library files included in your project.

As you may or may not know, Vanilla is built on top of a framework, and in the
relatively near future some more applications will be released on the same
framework. In an effort to better accomodate these separate projects, I've
separated the libraries for the framework and the user integration into their
own projects so they can all be maintained simultaneously and there won't be any
versioning problems. In order to get the Framework and People files included
in your vanilla library, you need to go to the directory _below_ your vanilla
repository. For example, on my local system I keep my working copy of Vanilla
in the following folder:

   C:\applications\subversion\vanilla

So, I am going to open up a command prompt and enter this:

   cd C:\applications\subversion

Now I am sitting at a command prompt like this:

   C:\applications\subversion>
   
First I'll include the Framework libraries with the following command:

   svn propset svn:externals "library/Framework http://lussumo.com/svn/framework/trunk" vanilla
   
Now, I'll include the People libraries with the following command:

   svn propset svn:externals "library/People http://lussumo.com/svn/people/trunk" vanilla
   
Up next we need to update our repository so it actually pulls in the latest
version of the libraries:

   cd vanilla
   svn update
   
At this point it will begin including all of the required libraries and placing
them in the following folders:

   C:\applications\subversion\vanilla\library\Framework\
   and
   C:\applications\subversion\vanilla\library\People\

===========
LOCAL SETUP
===========

Awesome, you now have all of the files required to run Vanilla. So, let's get
Vanilla set up on your machine properly. If you navigate to your repository's
conf folder, you'll see a bunch of files like English-dist.php and
settings-dist.php. The "-dist" means that they are included with the Vanilla
distribution, but you will need to create your own local copy of them in order
for Vanilla to work properly.

So, copy and paste each of the "*-dist.php" files and rename them to
"filename.php" (minus the "-dist"). Then open up each file and follow the
instructions inside. It's a pretty simple set of instructions for the most part.
The only file you'll really need to customize is the database.php file, which
you use to specify the connection parameters for your vanilla database.

======================
FRESH DATABASE INSTALL
======================

Great, so now we have a working set of files. Now let's get the database up and
running...

If you are installing a fresh version of vanilla and an empty database, your job
is actually pretty easy. In the vanilla repository is a setup folder. Within that
folder is a mysql.sql file that contains a set of SQL code which can be run to set
up a basic vanilla database.

From a command prompt you can use that file with the following command:

   mysql -u your_username -p your_password vanilla_db < C:\applications\subversion\vanilla\setup\mysql.sql
   
This code assumes that you've got a database in mysql named "vanilla_db" and it
also assumes that you replace "your_username" and "your_password" with your
mysql username and password respectively. Finally, it also assumes that your
repository is set up like mine in the path specified. You can change it to your
own local path, of course.

At this point you should have a working version of the database and you can sign
into the application using the username/password Admin/Admin.

====================
OLD DATABASE UPGRADE
====================

The task of upgrading a 0.9.2 (or earlier) database of Vanilla is a bit more
difficult than a fresh install (of course). You should definitely start by
making a copy of your existing database, name it something like "vanilla093".

In order for your vanilla installation to work, you will need to make some changes 
to your existing vanilla database. The required SQL is included below. Something to
be aware of is that Roles have been completely changed. Aside from three basic columns
in the LUM_Role table, all other role permissions are now managed through a serialized 
array. The SQL below removes all old role definitions and inserts a new "ALLOW ALL"
setup in every single role in your forum. So, DO NOT under any circumstances place
this code on a live server before first altering your roles so that basic members
do not have administrative priviledges.

So, open up mysql and "use vanilla093"

Now run the following SQL commands:

   -- Completely remove the old role table
   DROP TABLE IF EXISTS `LUM_Role`;
   -- Create the new role table
   CREATE TABLE `LUM_Role` (
     `RoleID` int(2) NOT NULL auto_increment,
     `Name` varchar(100) NOT NULL default '',
     `Icon` varchar(155) NOT NULL default '',
     `Description` varchar(200) NOT NULL default '',
     `Active` enum('1','0') NOT NULL default '1',
     `PERMISSION_SIGN_IN` enum('1','0') NOT NULL default '0',
     `PERMISSION_HTML_ALLOWED` enum('0','1') NOT NULL,
     `PERMISSION_RECEIVE_APPLICATION_NOTIFICATION` enum('1','0') NOT NULL default '0',
     `Permissions` text NOT NULL,
     `Priority` int(11) NOT NULL default '0',
     `UnAuthenticated` enum('1','0') NOT NULL default '0',
     PRIMARY KEY  (`RoleID`)
   );

   -- Insert the standard 6 roles
   INSERT INTO `LUM_Role` VALUES (1,'Unauthenticated','','','1','0','0','0','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";N;s:27:\"PERMISSION_START_DISCUSSION\";N;s:28:\"PERMISSION_STICK_DISCUSSIONS\";N;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";N;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";N;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";N;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";N;s:24:\"PERMISSION_EDIT_COMMENTS\";N;s:24:\"PERMISSION_HIDE_COMMENTS\";N;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";N;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";N;s:25:\"PERMISSION_ADD_CATEGORIES\";N;s:26:\"PERMISSION_EDIT_CATEGORIES\";N;s:28:\"PERMISSION_REMOVE_CATEGORIES\";N;s:26:\"PERMISSION_SORT_CATEGORIES\";N;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";N;s:29:\"PERMISSION_APPROVE_APPLICANTS\";N;s:27:\"PERMISSION_CHANGE_USER_ROLE\";N;s:21:\"PERMISSION_EDIT_USERS\";N;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";N;s:30:\"PERMISSION_MANAGE_REGISTRATION\";N;s:21:\"PERMISSION_SORT_ROLES\";N;s:20:\"PERMISSION_ADD_ROLES\";N;s:21:\"PERMISSION_EDIT_ROLES\";N;s:23:\"PERMISSION_REMOVE_ROLES\";N;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";N;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";N;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";N;s:26:\"PERMISSION_MANAGE_LANGUAGE\";N;s:24:\"PERMISSION_MANAGE_STYLES\";N;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";N;s:27:\"PERMISSION_DATABASE_CLEANUP\";N;}',0,'1'),
   (2,'Banned','','','1','0','0','0','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";N;s:27:\"PERMISSION_START_DISCUSSION\";N;s:28:\"PERMISSION_STICK_DISCUSSIONS\";N;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";N;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";N;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";N;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";N;s:24:\"PERMISSION_EDIT_COMMENTS\";N;s:24:\"PERMISSION_HIDE_COMMENTS\";N;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";N;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";N;s:25:\"PERMISSION_ADD_CATEGORIES\";N;s:26:\"PERMISSION_EDIT_CATEGORIES\";N;s:28:\"PERMISSION_REMOVE_CATEGORIES\";N;s:26:\"PERMISSION_SORT_CATEGORIES\";N;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";N;s:29:\"PERMISSION_APPROVE_APPLICANTS\";N;s:27:\"PERMISSION_CHANGE_USER_ROLE\";N;s:21:\"PERMISSION_EDIT_USERS\";N;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";N;s:30:\"PERMISSION_MANAGE_REGISTRATION\";N;s:21:\"PERMISSION_SORT_ROLES\";N;s:20:\"PERMISSION_ADD_ROLES\";N;s:21:\"PERMISSION_EDIT_ROLES\";N;s:23:\"PERMISSION_REMOVE_ROLES\";N;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";N;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";N;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";N;s:26:\"PERMISSION_MANAGE_LANGUAGE\";N;s:24:\"PERMISSION_MANAGE_STYLES\";N;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";N;s:27:\"PERMISSION_DATABASE_CLEANUP\";N;}',1,'0'),
   (3,'Member','','','1','1','1','0','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";i:1;s:27:\"PERMISSION_START_DISCUSSION\";i:1;s:28:\"PERMISSION_STICK_DISCUSSIONS\";N;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";N;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";N;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";N;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";N;s:24:\"PERMISSION_EDIT_COMMENTS\";N;s:24:\"PERMISSION_HIDE_COMMENTS\";N;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";N;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";N;s:25:\"PERMISSION_ADD_CATEGORIES\";N;s:26:\"PERMISSION_EDIT_CATEGORIES\";N;s:28:\"PERMISSION_REMOVE_CATEGORIES\";N;s:26:\"PERMISSION_SORT_CATEGORIES\";N;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";N;s:29:\"PERMISSION_APPROVE_APPLICANTS\";N;s:27:\"PERMISSION_CHANGE_USER_ROLE\";N;s:21:\"PERMISSION_EDIT_USERS\";N;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";N;s:30:\"PERMISSION_MANAGE_REGISTRATION\";N;s:21:\"PERMISSION_SORT_ROLES\";N;s:20:\"PERMISSION_ADD_ROLES\";N;s:21:\"PERMISSION_EDIT_ROLES\";N;s:23:\"PERMISSION_REMOVE_ROLES\";N;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";N;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";N;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";N;s:26:\"PERMISSION_MANAGE_LANGUAGE\";N;s:24:\"PERMISSION_MANAGE_STYLES\";N;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";N;s:27:\"PERMISSION_DATABASE_CLEANUP\";N;}',2,'0'),
   (4,'Moderator','','','1','1','1','0','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";i:1;s:27:\"PERMISSION_START_DISCUSSION\";i:1;s:28:\"PERMISSION_STICK_DISCUSSIONS\";i:1;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";i:1;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";i:1;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";i:1;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";i:1;s:24:\"PERMISSION_EDIT_COMMENTS\";i:1;s:24:\"PERMISSION_HIDE_COMMENTS\";i:1;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";i:1;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";i:1;s:25:\"PERMISSION_ADD_CATEGORIES\";N;s:26:\"PERMISSION_EDIT_CATEGORIES\";N;s:28:\"PERMISSION_REMOVE_CATEGORIES\";N;s:26:\"PERMISSION_SORT_CATEGORIES\";N;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";N;s:29:\"PERMISSION_APPROVE_APPLICANTS\";N;s:27:\"PERMISSION_CHANGE_USER_ROLE\";N;s:21:\"PERMISSION_EDIT_USERS\";N;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";N;s:30:\"PERMISSION_MANAGE_REGISTRATION\";N;s:21:\"PERMISSION_SORT_ROLES\";N;s:20:\"PERMISSION_ADD_ROLES\";N;s:21:\"PERMISSION_EDIT_ROLES\";N;s:23:\"PERMISSION_REMOVE_ROLES\";N;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";N;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";N;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";N;s:26:\"PERMISSION_MANAGE_LANGUAGE\";N;s:24:\"PERMISSION_MANAGE_STYLES\";N;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";N;s:27:\"PERMISSION_DATABASE_CLEANUP\";N;}',3,'0'),
   (5,'User Administrator','','','1','1','1','1','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";i:1;s:27:\"PERMISSION_START_DISCUSSION\";i:1;s:28:\"PERMISSION_STICK_DISCUSSIONS\";N;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";N;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";N;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";N;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";N;s:24:\"PERMISSION_EDIT_COMMENTS\";N;s:24:\"PERMISSION_HIDE_COMMENTS\";N;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";N;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";N;s:25:\"PERMISSION_ADD_CATEGORIES\";N;s:26:\"PERMISSION_EDIT_CATEGORIES\";N;s:28:\"PERMISSION_REMOVE_CATEGORIES\";N;s:26:\"PERMISSION_SORT_CATEGORIES\";N;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";N;s:29:\"PERMISSION_APPROVE_APPLICANTS\";i:1;s:27:\"PERMISSION_CHANGE_USER_ROLE\";i:1;s:21:\"PERMISSION_EDIT_USERS\";i:1;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";i:1;s:30:\"PERMISSION_MANAGE_REGISTRATION\";i:1;s:21:\"PERMISSION_SORT_ROLES\";N;s:20:\"PERMISSION_ADD_ROLES\";N;s:21:\"PERMISSION_EDIT_ROLES\";N;s:23:\"PERMISSION_REMOVE_ROLES\";N;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";N;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";N;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";N;s:26:\"PERMISSION_MANAGE_LANGUAGE\";N;s:24:\"PERMISSION_MANAGE_STYLES\";N;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";N;s:27:\"PERMISSION_DATABASE_CLEANUP\";N;}',4,'0'),
   (6,'Master Administrator','','','1','1','1','1','a:32:{s:23:\"PERMISSION_ADD_COMMENTS\";i:1;s:27:\"PERMISSION_START_DISCUSSION\";i:1;s:28:\"PERMISSION_STICK_DISCUSSIONS\";i:1;s:27:\"PERMISSION_HIDE_DISCUSSIONS\";i:1;s:28:\"PERMISSION_CLOSE_DISCUSSIONS\";i:1;s:27:\"PERMISSION_EDIT_DISCUSSIONS\";i:1;s:34:\"PERMISSION_VIEW_HIDDEN_DISCUSSIONS\";i:1;s:24:\"PERMISSION_EDIT_COMMENTS\";i:1;s:24:\"PERMISSION_HIDE_COMMENTS\";i:1;s:31:\"PERMISSION_VIEW_HIDDEN_COMMENTS\";i:1;s:44:\"PERMISSION_ADD_COMMENTS_TO_CLOSED_DISCUSSION\";i:1;s:25:\"PERMISSION_ADD_CATEGORIES\";i:1;s:26:\"PERMISSION_EDIT_CATEGORIES\";i:1;s:28:\"PERMISSION_REMOVE_CATEGORIES\";i:1;s:26:\"PERMISSION_SORT_CATEGORIES\";i:1;s:28:\"PERMISSION_VIEW_ALL_WHISPERS\";i:1;s:29:\"PERMISSION_APPROVE_APPLICANTS\";i:1;s:27:\"PERMISSION_CHANGE_USER_ROLE\";i:1;s:21:\"PERMISSION_EDIT_USERS\";i:1;s:31:\"PERMISSION_IP_ADDRESSES_VISIBLE\";i:1;s:30:\"PERMISSION_MANAGE_REGISTRATION\";i:1;s:21:\"PERMISSION_SORT_ROLES\";i:1;s:20:\"PERMISSION_ADD_ROLES\";i:1;s:21:\"PERMISSION_EDIT_ROLES\";i:1;s:23:\"PERMISSION_REMOVE_ROLES\";i:1;s:28:\"PERMISSION_CHECK_FOR_UPDATES\";i:1;s:38:\"PERMISSION_CHANGE_APPLICATION_SETTINGS\";i:1;s:28:\"PERMISSION_MANAGE_EXTENSIONS\";i:1;s:26:\"PERMISSION_MANAGE_LANGUAGE\";i:1;s:24:\"PERMISSION_MANAGE_STYLES\";i:1;s:27:\"PERMISSION_ALLOW_DEBUG_INFO\";i:1;s:27:\"PERMISSION_DATABASE_CLEANUP\";i:1;}',5,'0');

   -- Truncate all old role-related category access
   truncate table LUM_CategoryRoleBlock;
   -- Rename the settings column on the user table
   alter table LUM_User change Settings Preferences text;
   -- Place all users in the "Member" role
   update LUM_User set RoleID = 3;
   -- Place the first user in the database (assumed to be you) into the "Master Administrator" role.
   update LUM_User set RoleID = 6 where UserID = 1;
   -- Rename the "Order" column in the category table to "Priority" so that it is more query-friendly.
   alter table LUM_Category change `Order` Priority int not null default '0';


That's it. You should have a working version of Vanilla 0.9.3.
Good Luck, and if you have any questions, please go to

   http://lussumo.com/community

to ask them.